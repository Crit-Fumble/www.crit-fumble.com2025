#!/usr/bin/env sh
. "$(dirname "$0")/_/husky.sh"

# Get the current branch
BRANCH=$(git rev-parse --abbrev-ref HEAD)

echo "ğŸš€ Post-push hook triggered for branch: $BRANCH"

# Deploy to Vercel based on branch
if [ "$BRANCH" = "staging" ]; then
  echo "ğŸ“¦ Deploying to staging environment..."
  vercel --yes

  echo "ğŸ”— Assigning to staging subdomain..."
  vercel alias treefarm22-staging.crit-fumble.com --yes

  echo "âœ… Staging deployment complete!"
  echo "ğŸŒ URL: https://treefarm22-staging.crit-fumble.com"

elif [ "$BRANCH" = "main" ]; then
  echo "ğŸš€ Deploying to production..."
  vercel --prod --yes

  echo "âœ… Production deployment complete!"
  echo "ğŸŒ URL: https://www.crit-fumble.com"

else
  echo "â„¹ï¸  Not deploying - only staging and main branches auto-deploy"
fi
